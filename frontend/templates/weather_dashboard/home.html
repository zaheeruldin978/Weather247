{% extends 'base.html' %}
{% load static %}

{% block title %}Weather-247 - Global Weather Intelligence Platform{% endblock %}

{% block content %}
<!-- Premium Professional Header Section -->
<div class="relative overflow-hidden bg-gradient-to-br from-blue-900 via-blue-800 to-indigo-900 min-h-screen">
    <!-- Animated Background Elements -->
    <div class="absolute inset-0">
        <div class="absolute top-0 left-0 w-96 h-96 bg-blue-400/10 rounded-full blur-3xl animate-pulse"></div>
        <div class="absolute top-0 right-0 w-96 h-96 bg-indigo-400/10 rounded-full blur-3xl animate-pulse" style="animation-delay: 2s;"></div>
        <div class="absolute bottom-0 left-1/2 w-96 h-96 bg-purple-400/10 rounded-full blur-3xl animate-pulse" style="animation-delay: 4s;"></div>
    </div>
    
    <!-- Main Content Container -->
    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-20 pb-16">
<!-- Hero Section -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-white rounded-2xl mb-6 shadow-2xl" style="background-color: white !important; border: 2px solid white;">
                <div class="w-10 h-10 bg-white rounded-lg flex items-center justify-center relative overflow-hidden" style="background-color: white !important;">
                    <div class="absolute inset-0 bg-white z-10"></div>
                    <img src="{% static 'logo.png' %}" alt="Weather-247 Logo" class="w-10 h-10 object-contain rounded-lg relative z-20" style="background-color: white !important; filter: brightness(1.2) contrast(1.1);">
                </div>
            </div>
            <h1 class="text-4xl lg:text-6xl font-bold text-white mb-6 leading-tight">
                <span class="bg-gradient-to-r from-blue-200 via-white to-indigo-200 bg-clip-text text-transparent">
                    Weather-247
                </span>
                </h1>
            <p class="text-lg lg:text-xl text-blue-100 mb-8 max-w-3xl mx-auto leading-relaxed">
                Professional weather intelligence platform providing real-time data, predictive analytics, and location-aware insights for informed decision-making across the globe.
            </p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
                <button onclick="scrollToSearch()" class="group bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white px-6 py-3 rounded-xl font-semibold text-base transition-all duration-300 shadow-lg hover:shadow-blue-500/25 transform hover:scale-105">
                    <svg class="w-5 h-5 inline mr-2 group-hover:rotate-12 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    Start Exploring
                </button>
                <button onclick="scrollToFeatures()" class="group bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white px-6 py-3 rounded-xl font-semibold text-base transition-all duration-300 border border-white/20 hover:border-white/40 transform hover:scale-105">
                    <svg class="w-5 h-5 inline mr-2 group-hover:rotate-12 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    View Features
                </button>
                </div>
            </div>
        
        <!-- Premium Global Search Section -->
        <div id="search-section" class="mb-20">
            <div class="max-w-4xl mx-auto">
                <div class="text-center mb-8">
                    <h2 class="text-3xl lg:text-4xl font-bold text-white mb-4">Global Weather Search</h2>
                    <p class="text-lg text-blue-200">Discover weather conditions for any city, country, or location worldwide</p>
                    </div>
                
                <!-- Premium White Search Bar -->
                <div class="relative">
                    <div class="relative bg-white rounded-3xl p-0.5 shadow-2xl border border-gray-200 hover:border-gray-300 transition-all duration-300 search-bar-enhanced">
                        <div class="flex items-center">
                            <div class="flex-1 relative">
                                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                        </div>
                                <input type="text" id="global-search" placeholder="Search for any city, country, or location..." 
                                       class="w-full pl-12 pr-4 py-2 text-gray-900 text-base rounded-3xl border-0 focus:ring-2 focus:ring-gray-300/50 focus:outline-none bg-transparent placeholder-gray-500 transition-all duration-300 search-input-enhanced"
                                       style="display: block !important; visibility: visible !important; opacity: 1 !important;"
                                       oninput="handleSearchInput(this.value)"
                                       onkeypress="handleSearchKeypress(event)"
                                       onblur="handleSearchBlur()">
                            </div>
                            </div>
                        
                        <!-- Loading Indicator -->
                        <div id="search-loading" class="absolute right-4 top-1/2 transform -translate-y-1/2 hidden">
                            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-gray-400"></div>
                            </div>
                        </div>
                    
                    <!-- Enhanced Search Results Dropdown -->
                    <div id="search-results" class="absolute z-50 bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl mt-4 w-full hidden border border-white/20 max-h-96 overflow-y-auto">
                        <!-- Search results will be populated here -->
                    </div>
                </div>
                
                <!-- Search Instructions -->
                <div class="mt-6 text-center">
                    <p class="text-blue-200 text-lg mb-3">Try searching for:</p>
                    <div class="flex flex-wrap justify-center gap-3">
                        <span class="px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm border border-white/20 hover:bg-white/20 transition-all duration-300 cursor-pointer" onclick="searchForCity('London')">London</span>
                        <span class="px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm border border-white/20 hover:bg-white/20 transition-all duration-300 cursor-pointer" onclick="searchForCity('Tokyo')">Tokyo</span>
                        <span class="px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm border border-white/20 hover:bg-white/20 transition-all duration-300 cursor-pointer" onclick="searchForCity('New York')">New York</span>
                        <span class="px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm border border-white/20 hover:bg-white/20 transition-all duration-300 cursor-pointer" onclick="searchForCity('Gujranwala')">Gujranwala</span>
                        <span class="px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white text-sm border border-white/20 hover:bg-white/20 transition-all duration-300 cursor-pointer" onclick="searchForCity('Lahore')">Lahore</span>
            </div>
        </div>
                
                <!-- Enhanced Search Results Display - Positioned below search bar -->
                <div id="search-results-display" class="hidden mt-4 animate-fade-in-up">
                    <div class="bg-white/95 backdrop-blur-sm rounded-2xl p-4 shadow-xl border border-gray-200 max-w-4xl mx-auto">
                        <div class="text-center mb-4">
                            <div class="inline-flex items-center justify-center w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full mb-2 shadow-lg">
                                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
    </div>
                            <h3 class="text-xl font-bold text-gray-900 mb-1">Search Results</h3>
                            <p class="text-gray-600 text-sm">Weather data for your search</p>
                        </div>
                        <div id="search-results-content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                            <!-- Search results will be populated here -->
                        </div>
                        <div class="text-center mt-4">
                            <button onclick="hideSearchResults()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                                Clear Results
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Search Status -->
                <p id="search-status" class="text-center text-blue-200 mt-4 text-sm hidden"></p>
            </div>
        </div>
            </div>
        </div>
        
<!-- Enhanced Global Weather Map Section -->
<section id="global-weather" class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold text-gray-900 mb-4 font-display animate-fade-in-left">
                Interactive World Weather Map
            </h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto animate-fade-in-left">
                Explore weather data for any location worldwide with our comprehensive global coverage
            </p>
                    </div>
        
                <!-- Enhanced Compact Global Weather Intelligence Section -->
        <div class="bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 rounded-2xl p-6 mb-8 animate-fade-in-left border border-gray-100 shadow-lg">
            <div class="text-center mb-6">
                <h3 class="text-2xl lg:text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-3">
                    <svg class="inline-block w-12 h-12 mr-4 text-blue-600" fill="currentColor" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="10" fill="none" stroke="currentColor" stroke-width="2"/>
                        <path d="M12 2v20M2 12h20" stroke="currentColor" stroke-width="1.5" opacity="0.6"/>
                        <path d="M2.5 7.5c0-2.5 2-4.5 4.5-4.5s4.5 2 4.5 4.5-2 4.5-4.5 4.5-4.5-2-4.5-4.5z" fill="currentColor" opacity="0.8"/>
                        <path d="M14.5 16.5c0-2.5-2-4.5-4.5-4.5s-4.5 2-4.5 4.5 2 4.5 4.5 4.5 4.5-2 4.5-4.5z" fill="currentColor" opacity="0.6"/>
                        <path d="M12 2c-1.5 0-2.5 1-2.5 2.5s1 2.5 2.5 2.5 2.5-1 2.5-2.5S13.5 2 12 2z" fill="currentColor" opacity="0.9"/>
                        <path d="M12 19.5c-1.5 0-2.5-1-2.5-2.5s1-2.5 2.5-2.5 2.5 1 2.5 2.5-1 2.5-2.5 2.5z" fill="currentColor" opacity="0.7"/>
                        <circle cx="12" cy="12" r="1.5" fill="currentColor" opacity="1"/>
                    </svg>
                    Global Weather Intelligence
                </h3>
                <p class="text-gray-600 text-sm lg:text-base">Quick access to weather data across continents</p>
                </div>
            
            <!-- Enhanced Continent Grid with Multi-Color Gradients - Ordered by Popularity -->
            <div class="grid grid-cols-2 lg:grid-cols-7 gap-3 lg:gap-4">
                <!-- Asia - Most Popular -->
                <div class="bg-gradient-to-br from-green-600 via-green-500 to-green-400 rounded-xl cursor-pointer hover:from-green-700 hover:via-green-600 hover:to-green-500 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('Asia')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        🏛️
                    </div>
                    <div class="text-xs lg:text-sm text-center">Asia</div>
            </div>
            
                <!-- Europe - Second Most Popular -->
                <div class="bg-gradient-to-br from-blue-400 via-indigo-500 to-purple-600 rounded-xl cursor-pointer hover:from-blue-500 hover:via-indigo-600 hover:to-purple-700 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('Europe')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        🏰
                    </div>
                    <div class="text-xs lg:text-sm text-center">Europe</div>
                </div>
                
                <!-- North America - Third Most Popular -->
                <div class="bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-600 rounded-xl cursor-pointer hover:from-emerald-500 hover:via-teal-600 hover:to-cyan-700 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('North America')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        🗽
                    </div>
                    <div class="text-xs lg:text-sm text-center">North America</div>
            </div>
            
                <!-- Africa - Fourth Most Popular -->
                <div class="bg-gradient-to-br from-amber-400 via-orange-500 to-red-600 rounded-xl cursor-pointer hover:from-amber-500 hover:via-orange-600 hover:to-red-700 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('Africa')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        🐪
                    </div>
                    <div class="text-xs lg:text-sm text-center">Africa</div>
                </div>
                
                <!-- South America - Fifth Most Popular -->
                <div class="bg-gradient-to-br from-lime-400 via-green-500 to-emerald-600 rounded-xl cursor-pointer hover:from-lime-500 hover:via-green-600 hover:to-emerald-700 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('South America')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        🌴
                    </div>
                    <div class="text-xs lg:text-sm text-center">South America</div>
            </div>
            
                <!-- Australia - Sixth Most Popular -->
                <div class="bg-gradient-to-br from-purple-400 via-violet-500 to-fuchsia-600 rounded-xl cursor-pointer hover:from-purple-500 hover:via-violet-600 hover:to-fuchsia-700 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('Australia')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        🦘
                    </div>
                    <div class="text-xs lg:text-sm text-center">Australia</div>
                </div>
                
                <!-- Antarctica - Least Popular -->
                <div class="bg-gradient-to-br from-slate-400 via-gray-500 to-zinc-600 rounded-xl cursor-pointer hover:from-slate-500 hover:via-gray-600 hover:to-zinc-700 transition-all duration-300 flex flex-col items-center justify-center p-4 text-white font-semibold shadow-lg hover:shadow-xl transform hover:scale-105" 
                     onclick="showRegionWeather('Antarctica')">
                    <div class="w-8 h-8 mb-2 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                        ❄️
                    </div>
                    <div class="text-xs lg:text-sm text-center">Antarctica</div>
                </div>
            </div>
            
            <!-- Enhanced Stats with Multi-Color Gradients -->
            <div class="mt-6 grid grid-cols-4 gap-3">
                <div class="text-center bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 rounded-lg p-3 border border-blue-100 shadow-sm hover:shadow-md transition-all duration-300">
                    <div class="w-8 h-8 mx-auto mb-2 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                    </div>
                    <div class="text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-1">200+</div>
                    <div class="text-xs text-gray-600">Countries</div>
                </div>
                <div class="text-center bg-gradient-to-br from-emerald-50 via-teal-50 to-cyan-50 rounded-lg p-3 border border-emerald-100 shadow-sm hover:shadow-md transition-all duration-300">
                    <div class="w-8 h-8 mx-auto mb-2 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </div>
                    <div class="text-lg font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent mb-1">50K+</div>
                    <div class="text-xs text-gray-600">Cities</div>
                </div>
                <div class="text-center bg-gradient-to-br from-purple-50 via-violet-50 to-fuchsia-50 rounded-lg p-3 border border-purple-100 shadow-sm hover:shadow-md transition-all duration-300">
                    <div class="w-8 h-8 mx-auto mb-2 bg-gradient-to-br from-purple-500 to-violet-600 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div class="text-lg font-bold bg-gradient-to-r from-purple-600 to-violet-600 bg-clip-text text-transparent mb-1">24/7</div>
                    <div class="text-xs text-gray-600">Monitoring</div>
                </div>
                <div class="text-center bg-gradient-to-br from-orange-50 via-red-50 to-pink-50 rounded-lg p-3 border border-orange-100 shadow-sm hover:shadow-md transition-all duration-300">
                    <div class="w-8 h-8 mx-auto mb-2 bg-gradient-to-br from-orange-500 to-red-600 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div class="text-lg font-bold bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-1">99.9%</div>
                    <div class="text-xs text-gray-600">Uptime</div>
                </div>
            </div>
            
        <!-- Enhanced Region Weather Display -->
        <div id="region-weather" class="hidden animate-fade-in-left">
            <div class="bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-xl p-8 border border-gray-200">
                <div class="flex items-center justify-between mb-6">
                    <div>
                        <h3 id="region-title" class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-2"></h3>
                        <p class="text-gray-600">Live weather data for major cities in this region</p>
                    </div>
                    <button onclick="hideRegionWeather()" class="text-gray-500 hover:text-gray-700 bg-gray-100 hover:bg-gray-200 p-2 rounded-lg transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <div id="region-cities" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Cities will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Enhanced Live Global Weather Grid -->
<section class="py-20 bg-gradient-to-br from-gray-50 to-blue-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold text-gray-900 mb-4 font-display animate-fade-in-left">
                Live Global Weather Intelligence
            </h2>
            <p class="text-xl text-gray-600 animate-fade-in-left">
                Real-time weather data from major cities and locations worldwide
            </p>
                </div>
        
        <!-- Enhanced Weather Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="live-weather">
            <!-- Weather cards will be populated by JavaScript -->
            </div>
        
        <!-- Enhanced Load More Button -->
        <div class="text-center mt-8 animate-fade-in-left">
            <button onclick="loadMoreCities()" class="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-4 rounded-2xl font-medium transition-all duration-300 transform hover:scale-105 shadow-lg">
                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
                Load More Cities
            </button>
                </div>
            </div>
</section>

<!-- Enterprise Features Section -->
<section id="features" class="py-20 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
            <h2 class="text-4xl font-bold text-gray-900 mb-4 font-display animate-fade-in-left">
                Enterprise-Grade Weather Intelligence
            </h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto animate-fade-in-left">
                Comprehensive weather solutions designed for businesses, organizations, and professionals who need accurate, 
                location-aware weather data for critical decision-making.
            </p>
                </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 animate-fade-in-left">
            <!-- Global Coverage -->
            <div class="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-8 card-hover feature-card card-animate animate-scale-in border border-blue-100">
                <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300 icon-container">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
            </div>
                <h3 class="text-xl font-bold text-gray-900 mb-4">Global Location Coverage</h3>
                <p class="text-gray-600 mb-4">Access weather data for any city, town, or coordinates worldwide with pinpoint accuracy and comprehensive coverage.</p>
                <a href="{% url 'weather_dashboard:dashboard' %}" class="inline-flex items-center text-blue-600 hover:text-blue-700 font-medium">
                    Explore Coverage
                    <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </a>
                </div>
            
            <!-- AI Forecasting -->
            <div class="bg-gradient-to-br from-purple-50 to-pink-100 rounded-2xl p-8 card-hover feature-card card-animate animate-scale-in border border-purple-100">
                <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300 icon-container">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
            </div>
                <h3 class="text-xl font-bold text-gray-900 mb-4">Advanced Predictive Analytics</h3>
                <p class="text-gray-600 mb-4">Machine learning-powered forecasting with 96% accuracy for up to 7 days, providing critical insights for planning and operations.</p>
                <a href="{% url 'weather_dashboard:forecast' %}" class="inline-flex items-center text-purple-600 hover:text-purple-700 font-medium">
                    Generate Forecasts
                    <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </a>
            </div>
            
            <!-- Multi-Location Analysis -->
            <div class="bg-gradient-to-br from-green-50 to-emerald-100 rounded-2xl p-8 card-hover feature-card card-animate animate-scale-in border border-green-100">
                <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300 icon-container">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-4">Multi-Location Intelligence</h3>
                <p class="text-gray-600 mb-4">Compare weather patterns across multiple locations simultaneously with advanced analytics and interactive visualizations.</p>
                <a href="{% url 'weather_dashboard:compare_cities' %}" class="inline-flex items-center text-green-600 hover:text-green-700 font-medium">
                    Compare Locations
                    <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </a>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="py-20 bg-gradient-to-r from-blue-600 to-purple-600">
    <div class="max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8">
        <h2 class="text-4xl font-bold text-white mb-6 font-display animate-fade-in-left">
            Ready to Access Global Weather Intelligence?
        </h2>
        <p class="text-xl text-blue-100 mb-8 animate-fade-in-left">
            Join thousands of professionals and organizations worldwide who trust Weather-247 for critical weather insights and strategic decision-making.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center animate-fade-in-left">
            <a href="{% url 'weather_dashboard:dashboard' %}" class="bg-white text-blue-600 px-8 py-4 rounded-xl font-semibold text-lg hover:bg-gray-100 transition-all duration-300 transform hover:scale-105 shadow-lg btn-primary animate-fade-in-left">
                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v6H8V5z"></path>
                </svg>
                Launch Platform
            </a>
            <a href="{% url 'weather_dashboard:compare_cities' %}" class="border-2 border-white text-white px-8 py-4 rounded-xl font-semibold text-lg hover:bg-white hover:text-blue-600 transition-all duration-300 animate-fade-in-right">
                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
                Global Comparison
            </a>
        </div>
    </div>
</section>

{% endblock %}

{% block extra_js %}
<script>
// Global variables for weather data
let currentCities = [];
let displayedCities = 8;
const allCities = [
    // Major Global Cities
    'London', 'New York', 'Tokyo', 'Sydney', 'Dubai', 'Mumbai', 'Paris', 'Berlin',
    'Moscow', 'Beijing', 'Rio de Janeiro', 'Cape Town', 'Toronto', 'Singapore', 'Seoul', 'Mexico City',
    'Istanbul', 'Bangkok', 'Cairo', 'Lagos', 'Kinshasa', 'Lima', 'Buenos Aires', 'Santiago',
    'Vancouver', 'Montreal', 'Chicago', 'Los Angeles', 'Miami', 'Houston', 'Phoenix', 'Philadelphia',
    
    // Pakistani Cities
    'Karachi', 'Lahore', 'Islamabad', 'Faisalabad', 'Rawalpindi', 'Multan', 'Gujranwala', 'Peshawar',
    'Quetta', 'Sialkot', 'Bahawalpur', 'Sargodha', 'Sukkur', 'Jhang', 'Sheikhupura', 'Rahim Yar Khan',
    'Gujrat', 'Mardan', 'Kasur', 'Dera Ghazi Khan', 'Sahiwal', 'Nawabshah', 'Mirpur Khas', 'Okara',
    'Rahim Yar Khan', 'Chiniot', 'Kamoke', 'Hafizabad', 'Sadiqabad', 'Burewala', 'Khanewal',
    
    // Indian Cities
    'Delhi', 'Mumbai', 'Bangalore', 'Hyderabad', 'Chennai', 'Kolkata', 'Ahmedabad', 'Pune',
    'Jaipur', 'Surat', 'Lucknow', 'Kanpur', 'Nagpur', 'Indore', 'Thane', 'Bhopal',
    'Patna', 'Vadodara', 'Ghaziabad', 'Ludhiana', 'Agra', 'Nashik', 'Faridabad', 'Meerut',
    'Rajkot', 'Kalyan', 'Vasai', 'Varanasi', 'Srinagar', 'Aurangabad', 'Navi Mumbai', 'Solapur',
    
    // Middle Eastern Cities
    'Riyadh', 'Jeddah', 'Doha', 'Kuwait City', 'Manama', 'Muscat', 'Amman', 'Beirut',
    'Damascus', 'Baghdad', 'Tehran', 'Kabul', 'Tashkent', 'Ashgabat', 'Bishkek', 'Dushanbe',
    'Abu Dhabi', 'Sharjah', 'Al Ain', 'Fujairah', 'Ras Al Khaimah', 'Umm Al Quwain', 'Ajman',
    'Sanaa', 'Aden', 'Taiz', 'Hodeidah', 'Ibb', 'Dhamar', 'Al Mukalla', 'Zinjibar',
    
    // European Cities
    'Rome', 'Madrid', 'Amsterdam', 'Brussels', 'Vienna', 'Prague', 'Warsaw', 'Budapest',
    'Stockholm', 'Oslo', 'Copenhagen', 'Helsinki', 'Dublin', 'Lisbon', 'Athens', 'Bucharest',
    'Barcelona', 'Milan', 'Munich', 'Frankfurt', 'Hamburg', 'Cologne', 'Düsseldorf', 'Stuttgart',
    'Rotterdam', 'The Hague', 'Utrecht', 'Eindhoven', 'Tilburg', 'Groningen', 'Almere', 'Breda',
    
    // Asian Cities
    'Hong Kong', 'Taipei', 'Bangkok', 'Manila', 'Jakarta', 'Kuala Lumpur', 'Hanoi', 'Phnom Penh',
    'Vientiane', 'Yangon', 'Ulaanbaatar', 'Pyongyang', 'Vladivostok', 'Novosibirsk', 'Yekaterinburg', 'Kazan',
    'Shanghai', 'Guangzhou', 'Shenzhen', 'Chengdu', 'Tianjin', 'Chongqing', 'Nanjing', 'Wuhan',
    'Xi\'an', 'Jinan', 'Hangzhou', 'Zhengzhou', 'Changsha', 'Fuzhou', 'Nanchang', 'Shijiazhuang',
    
    // African Cities
    'Nairobi', 'Addis Ababa', 'Dar es Salaam', 'Khartoum', 'Algiers', 'Casablanca', 'Tunis', 'Tripoli',
    'Accra', 'Abuja', 'Kinshasa', 'Luanda', 'Lusaka', 'Harare', 'Gaborone', 'Windhoek',
    'Johannesburg', 'Pretoria', 'Durban', 'Port Elizabeth', 'Bloemfontein', 'East London', 'Kimberley',
    'Lagos', 'Ibadan', 'Kano', 'Kaduna', 'Port Harcourt', 'Benin City', 'Maiduguri', 'Zaria',
    
    // American Cities
    'Vancouver', 'Calgary', 'Edmonton', 'Winnipeg', 'Ottawa', 'Quebec City', 'Halifax', 'St. John\'s',
    'San Francisco', 'Seattle', 'Denver', 'Austin', 'Nashville', 'Charlotte', 'Atlanta', 'Orlando',
    'Boston', 'Detroit', 'Minneapolis', 'Cleveland', 'Cincinnati', 'Kansas City', 'St. Louis', 'Pittsburgh',
    'Baltimore', 'Tampa', 'Jacksonville', 'Columbus', 'Indianapolis', 'Milwaukee', 'Memphis', 'Louisville',
    
    // South American Cities
    'São Paulo', 'Buenos Aires', 'Rio de Janeiro', 'Lima', 'Bogotá', 'Santiago', 'Caracas', 'Quito',
    'Montevideo', 'Asunción', 'La Paz', 'Sucre', 'Brasília', 'Salvador', 'Recife', 'Fortaleza',
    'Belo Horizonte', 'Manaus', 'Curitiba', 'Porto Alegre', 'Guarulhos', 'Campinas', 'Nova Iguaçu',
    'Medellín', 'Cali', 'Barranquilla', 'Cartagena', 'Cúcuta', 'Bucaramanga', 'Pereira', 'Manizales',
    
    // Australian Cities
    'Sydney', 'Melbourne', 'Brisbane', 'Perth', 'Adelaide', 'Canberra', 'Gold Coast', 'Newcastle',
    'Wollongong', 'Sunshine Coast', 'Geelong', 'Townsville', 'Cairns', 'Toowoomba', 'Ballarat', 'Bendigo',
    'Albury', 'Wodonga', 'Launceston', 'Mackay', 'Rockhampton', 'Bundaberg', 'Coffs Harbour', 'Port Macquarie',
    
    // Canadian Cities
    'Toronto', 'Montreal', 'Vancouver', 'Calgary', 'Edmonton', 'Ottawa', 'Winnipeg', 'Quebec City',
    'Hamilton', 'Kitchener', 'London', 'Victoria', 'Halifax', 'Oshawa', 'Windsor', 'Saskatoon',
    'Regina', 'St. John\'s', 'Kelowna', 'Kingston', 'Sherbrooke', 'Trois-Rivières', 'Guelph', 'Brantford',
    
    // Chinese Cities
    'Beijing', 'Shanghai', 'Guangzhou', 'Shenzhen', 'Chengdu', 'Tianjin', 'Chongqing', 'Nanjing',
    'Wuhan', 'Xi\'an', 'Jinan', 'Hangzhou', 'Zhengzhou', 'Changsha', 'Fuzhou', 'Nanchang',
    'Shijiazhuang', 'Kunming', 'Nanchang', 'Harbin', 'Changchun', 'Shenyang', 'Hohhot', 'Yinchuan',
    'Xining', 'Lhasa', 'Urumqi', 'Lanzhou', 'Xining', 'Yinchuan', 'Hohhot', 'Lhasa',
    
    // Japanese Cities
    'Tokyo', 'Osaka', 'Nagoya', 'Sapporo', 'Fukuoka', 'Kobe', 'Kyoto', 'Kawasaki',
    'Yokohama', 'Saitama', 'Chiba', 'Sendai', 'Hiroshima', 'Kitakyushu', 'Sakai', 'Niigata',
    'Hamamatsu', 'Kumamoto', 'Sagamihara', 'Shizuoka', 'Okayama', 'Kagoshima', 'Matsuyama', 'Toyama',
    
    // Korean Cities
    'Seoul', 'Busan', 'Incheon', 'Daegu', 'Daejeon', 'Gwangju', 'Suwon', 'Ulsan',
    'Seongnam', 'Bucheon', 'Ansan', 'Jeonju', 'Anyang', 'Pohang', 'Changwon', 'Jeju',
    
    // Russian Cities
    'Moscow', 'Saint Petersburg', 'Novosibirsk', 'Yekaterinburg', 'Kazan', 'Nizhny Novgorod', 'Chelyabinsk',
    'Samara', 'Rostov-on-Don', 'Ufa', 'Perm', 'Volgograd', 'Krasnodar', 'Saratov', 'Tyumen',
    'Tolyatti', 'Izhevsk', 'Barnaul', 'Ulyanovsk', 'Irkutsk', 'Khabarovsk', 'Yaroslavl', 'Vladivostok',
    
    // Brazilian Cities
    'São Paulo', 'Rio de Janeiro', 'Brasília', 'Salvador', 'Fortaleza', 'Belo Horizonte', 'Manaus',
    'Curitiba', 'Recife', 'Porto Alegre', 'Belém', 'Goiânia', 'Guarulhos', 'Campinas', 'Nova Iguaçu',
    'São Luís', 'Maceió', 'Teresina', 'Natal', 'Campo Grande', 'João Pessoa', 'Teresina', 'Aracaju',
    
    // Mexican Cities
    'Mexico City', 'Guadalajara', 'Monterrey', 'Puebla', 'Tijuana', 'Ciudad Juárez', 'León',
    'Zapopan', 'Monterrey', 'Nezahualcóyotl', 'Chihuahua', 'Mérida', 'Aguascalientes', 'Tampico',
    'Cuernavaca', 'Morelia', 'Chilpancingo', 'Toluca', 'Querétaro', 'San Luis Potosí', 'Hermosillo',
    
    // Turkish Cities
    'Istanbul', 'Ankara', 'Izmir', 'Bursa', 'Antalya', 'Adana', 'Konya', 'Gaziantep',
    'Kayseri', 'Mersin', 'Diyarbakır', 'Samsun', 'Denizli', 'Eskişehir', 'Trabzon', 'Erzurum',
    'Van', 'Batman', 'Elazığ', 'Malatya', 'Şanlıurfa', 'Kırıkkale', 'Aksaray', 'Niğde',
    
    // Egyptian Cities
    'Cairo', 'Alexandria', 'Giza', 'Shubra El Kheima', 'Port Said', 'Suez', 'Luxor', 'Mansoura',
    'El-Mahalla El-Kubra', 'Aswan', 'Asyut', 'Zagazig', 'Ismailia', 'Faiyum', 'Sohag', 'Beni Suef',
    
    // South African Cities
    'Johannesburg', 'Cape Town', 'Durban', 'Pretoria', 'Port Elizabeth', 'Bloemfontein', 'East London',
    'Kimberley', 'Nelspruit', 'Polokwane', 'Mahikeng', 'Bisho', 'Bhisho', 'Kimberley', 'Bloemfontein',
    
    // Indonesian Cities
    'Jakarta', 'Surabaya', 'Bandung', 'Medan', 'Semarang', 'Palembang', 'Makassar', 'Tangerang',
    'Depok', 'Bekasi', 'Bogor', 'Malang', 'Surakarta', 'Yogyakarta', 'Cirebon', 'Tasikmalaya',
    
    // Malaysian Cities
    'Kuala Lumpur', 'George Town', 'Ipoh', 'Shah Alam', 'Petaling Jaya', 'Johor Bahru', 'Malacca City',
    'Alor Setar', 'Miri', 'Kuching', 'Kota Kinabalu', 'Sandakan', 'Tawau', 'Lahad Datu', 'Semporna',
    
    // Thai Cities
    'Bangkok', 'Chiang Mai', 'Pattaya', 'Phuket', 'Hat Yai', 'Nakhon Ratchasima', 'Udon Thani',
    'Chiang Rai', 'Nakhon Si Thammarat', 'Khon Kaen', 'Ubon Ratchathani', 'Nakhon Sawan', 'Saraburi',
    
    // Vietnamese Cities
    'Ho Chi Minh City', 'Hanoi', 'Da Nang', 'Hai Phong', 'Can Tho', 'Bien Hoa', 'Hue', 'Nha Trang',
    'Buon Ma Thuot', 'Vung Tau', 'Qui Nhon', 'Rach Gia', 'Long Xuyen', 'My Tho', 'Tay Ninh', 'Bac Lieu',
    
    // Philippine Cities
    'Manila', 'Quezon City', 'Davao City', 'Caloocan', 'Cebu City', 'Zamboanga City', 'Antipolo',
    'Pasig', 'Taguig', 'Valenzuela', 'Parañaque', 'Makati', 'Marikina', 'Muntinlupa', 'Las Piñas',
    'Bacoor', 'General Santos', 'Iloilo City', 'Cagayan de Oro', 'Bacolod', 'Iligan', 'Mandaue',
    
    // More Pakistani Cities
    'Gujrat', 'Mardan', 'Kasur', 'Dera Ghazi Khan', 'Sahiwal', 'Nawabshah', 'Mirpur Khas', 'Okara',
    'Rahim Yar Khan', 'Chiniot', 'Kamoke', 'Hafizabad', 'Sadiqabad', 'Burewala', 'Khanewal', 'Jhelum',
    'Sargodha', 'Bahawalpur', 'Rahim Yar Khan', 'Dera Ghazi Khan', 'Sahiwal', 'Nawabshah', 'Mirpur Khas',
    'Okara', 'Rahim Yar Khan', 'Chiniot', 'Kamoke', 'Hafizabad', 'Sadiqabad', 'Burewala', 'Khanewal',
    
    // More Indian Cities
    'Jodhpur', 'Ranchi', 'Raipur', 'Kochi', 'Coimbatore', 'Vadodara', 'Patna', 'Indore', 'Bhopal',
    'Ludhiana', 'Agra', 'Nashik', 'Faridabad', 'Meerut', 'Rajkot', 'Kalyan', 'Vasai', 'Varanasi',
    'Srinagar', 'Aurangabad', 'Navi Mumbai', 'Solapur', 'Jabalpur', 'Gwalior', 'Vijayawada', 'Guntur',
    
    // More Middle Eastern Cities
    'Abu Dhabi', 'Sharjah', 'Al Ain', 'Fujairah', 'Ras Al Khaimah', 'Umm Al Quwain', 'Ajman',
    'Sanaa', 'Aden', 'Taiz', 'Hodeidah', 'Ibb', 'Dhamar', 'Al Mukalla', 'Zinjibar', 'Mukalla',
    'Al Hudaydah', 'Ibb', 'Dhamar', 'Al Mukalla', 'Zinjibar', 'Mukalla', 'Al Hudaydah', 'Ibb',
    
    // More European Cities
    'Barcelona', 'Milan', 'Munich', 'Frankfurt', 'Hamburg', 'Cologne', 'Düsseldorf', 'Stuttgart',
    'Rotterdam', 'The Hague', 'Utrecht', 'Eindhoven', 'Tilburg', 'Groningen', 'Almere', 'Breda',
    'Antwerp', 'Ghent', 'Charleroi', 'Liège', 'Bruges', 'Namur', 'Leuven', 'Mons',
    
    // More Asian Cities
    'Shanghai', 'Guangzhou', 'Shenzhen', 'Chengdu', 'Tianjin', 'Chongqing', 'Nanjing', 'Wuhan',
    'Xi\'an', 'Jinan', 'Hangzhou', 'Zhengzhou', 'Changsha', 'Fuzhou', 'Nanchang', 'Shijiazhuang',
    
    // More African Cities
    'Johannesburg', 'Pretoria', 'Durban', 'Port Elizabeth', 'Bloemfontein', 'East London', 'Kimberley',
    'Nelspruit', 'Polokwane', 'Mahikeng', 'Bisho', 'Bhisho', 'Kimberley', 'Bloemfontein', 'Nelspruit',
    'Polokwane', 'Mahikeng', 'Bisho', 'Bhisho', 'Kimberley', 'Bloemfontein', 'Nelspruit', 'Polokwane',
    
    // More American Cities
    'Boston', 'Detroit', 'Minneapolis', 'Cleveland', 'Cincinnati', 'Kansas City', 'St. Louis', 'Pittsburgh',
    'Baltimore', 'Tampa', 'Jacksonville', 'Columbus', 'Indianapolis', 'Milwaukee', 'Memphis', 'Louisville',
    'Richmond', 'Raleigh', 'Nashville', 'Charlotte', 'Atlanta', 'Orlando', 'Miami', 'Jacksonville',
    
    // More South American Cities
    'Belo Horizonte', 'Manaus', 'Curitiba', 'Porto Alegre', 'Guarulhos', 'Campinas', 'Nova Iguaçu',
    'São Luís', 'Maceió', 'Teresina', 'Natal', 'Campo Grande', 'João Pessoa', 'Teresina', 'Aracaju',
    'Medellín', 'Cali', 'Barranquilla', 'Cartagena', 'Cúcuta', 'Bucaramanga', 'Pereira', 'Manizales',
    'Bogotá', 'Cali', 'Medellín', 'Barranquilla', 'Cartagena', 'Cúcuta', 'Bucaramanga', 'Pereira',
    
    // More Australian Cities
    'Gold Coast', 'Newcastle', 'Wollongong', 'Sunshine Coast', 'Geelong', 'Townsville', 'Cairns', 'Toowoomba',
    'Ballarat', 'Bendigo', 'Albury', 'Wodonga', 'Launceston', 'Mackay', 'Rockhampton', 'Bundaberg',
    'Coffs Harbour', 'Port Macquarie', 'Albury', 'Wodonga', 'Launceston', 'Mackay', 'Rockhampton', 'Bundaberg',
    
    // More Canadian Cities
    'Hamilton', 'Kitchener', 'London', 'Victoria', 'Halifax', 'Oshawa', 'Windsor', 'Saskatoon',
    'Regina', 'St. John\'s', 'Kelowna', 'Kingston', 'Sherbrooke', 'Trois-Rivières', 'Guelph', 'Brantford',
    'Thunder Bay', 'Sudbury', 'Windsor', 'Saskatoon', 'Regina', 'St. John\'s', 'Kelowna', 'Kingston',
    
    // More Chinese Cities
    'Kunming', 'Nanchang', 'Harbin', 'Changchun', 'Shenyang', 'Hohhot', 'Yinchuan', 'Xining',
    'Lhasa', 'Urumqi', 'Lanzhou', 'Xining', 'Yinchuan', 'Hohhot', 'Lhasa', 'Urumqi',
    'Lanzhou', 'Xining', 'Yinchuan', 'Hohhot', 'Lhasa', 'Urumqi', 'Lanzhou', 'Xining',
    
    // More Japanese Cities
    'Hamamatsu', 'Kumamoto', 'Sagamihara', 'Shizuoka', 'Okayama', 'Kagoshima', 'Matsuyama', 'Toyama',
    'Fukuyama', 'Hachinohe', 'Matsue', 'Tottori', 'Kofu', 'Mito', 'Fukushima', 'Yamagata',
    'Akita', 'Morioka', 'Aomori', 'Hirosaki', 'Hachinohe', 'Matsue', 'Tottori', 'Kofu',
    
    // More Korean Cities
    'Seongnam', 'Bucheon', 'Ansan', 'Jeonju', 'Anyang', 'Pohang', 'Changwon', 'Jeju',
    'Goyang', 'Yongin', 'Seongnam', 'Bucheon', 'Ansan', 'Jeonju', 'Anyang', 'Pohang',
    'Changwon', 'Jeju', 'Goyang', 'Yongin', 'Seongnam', 'Bucheon', 'Ansan', 'Jeonju',
    
    // More Russian Cities
    'Tolyatti', 'Izhevsk', 'Barnaul', 'Ulyanovsk', 'Irkutsk', 'Khabarovsk', 'Yaroslavl', 'Vladivostok',
    'Tolyatti', 'Izhevsk', 'Barnaul', 'Ulyanovsk', 'Irkutsk', 'Khabarovsk', 'Yaroslavl', 'Vladivostok',
    'Tolyatti', 'Izhevsk', 'Barnaul', 'Ulyanovsk', 'Irkutsk', 'Khabarovsk', 'Yaroslavl', 'Vladivostok',
    
    // More Brazilian Cities
    'São Luís', 'Maceió', 'Teresina', 'Natal', 'Campo Grande', 'João Pessoa', 'Teresina', 'Aracaju',
    'São Luís', 'Maceió', 'Teresina', 'Natal', 'Campo Grande', 'João Pessoa', 'Teresina', 'Aracaju',
    'São Luís', 'Maceió', 'Teresina', 'Natal', 'Campo Grande', 'João Pessoa', 'Teresina', 'Aracaju',
    
    // More Mexican Cities
    'Cuernavaca', 'Morelia', 'Chilpancingo', 'Toluca', 'Querétaro', 'San Luis Potosí', 'Hermosillo',
    'Cuernavaca', 'Morelia', 'Chilpancingo', 'Toluca', 'Querétaro', 'San Luis Potosí', 'Hermosillo',
    'Cuernavaca', 'Morelia', 'Chilpancingo', 'Toluca', 'Querétaro', 'San Luis Potosí', 'Hermosillo',
    
    // More Turkish Cities
    'Van', 'Batman', 'Elazığ', 'Malatya', 'Şanlıurfa', 'Kırıkkale', 'Aksaray', 'Niğde',
    'Van', 'Batman', 'Elazığ', 'Malatya', 'Şanlıurfa', 'Kırıkkale', 'Aksaray', 'Niğde',
    'Van', 'Batman', 'Elazığ', 'Malatya', 'Şanlıurfa', 'Kırıkkale', 'Aksaray', 'Niğde',
    
    // More Egyptian Cities
    'El-Mahalla El-Kubra', 'Aswan', 'Asyut', 'Zagazig', 'Ismailia', 'Faiyum', 'Sohag', 'Beni Suef',
    'El-Mahalla El-Kubra', 'Aswan', 'Asyut', 'Zagazig', 'Ismailia', 'Faiyum', 'Sohag', 'Beni Suef',
    'El-Mahalla El-Kubra', 'Aswan', 'Asyut', 'Zagazig', 'Ismailia', 'Faiyum', 'Sohag', 'Beni Suef',
    
    // More South African Cities
    'Nelspruit', 'Polokwane', 'Mahikeng', 'Bisho', 'Bhisho', 'Kimberley', 'Bloemfontein', 'Nelspruit',
    'Polokwane', 'Mahikeng', 'Bisho', 'Bhisho', 'Kimberley', 'Bloemfontein', 'Nelspruit', 'Polokwane',
    'Mahikeng', 'Bisho', 'Bhisho', 'Kimberley', 'Bloemfontein', 'Nelspruit', 'Polokwane', 'Mahikeng',
    
    // More Indonesian Cities
    'Depok', 'Bekasi', 'Bogor', 'Malang', 'Surakarta', 'Yogyakarta', 'Cirebon', 'Tasikmalaya',
    'Depok', 'Bekasi', 'Bogor', 'Malang', 'Surakarta', 'Yogyakarta', 'Cirebon', 'Tasikmalaya',
    'Depok', 'Bekasi', 'Bogor', 'Malang', 'Surakarta', 'Yogyakarta', 'Cirebon', 'Tasikmalaya',
    
    // More Malaysian Cities
    'Alor Setar', 'Miri', 'Kuching', 'Kota Kinabalu', 'Sandakan', 'Tawau', 'Lahad Datu', 'Semporna',
    'Alor Setar', 'Miri', 'Kuching', 'Kota Kinabalu', 'Sandakan', 'Tawau', 'Lahad Datu', 'Semporna',
    'Alor Setar', 'Miri', 'Kuching', 'Kota Kinabalu', 'Sandakan', 'Tawau', 'Lahad Datu', 'Semporna',
    
    // More Thai Cities
    'Chiang Rai', 'Nakhon Si Thammarat', 'Khon Kaen', 'Ubon Ratchathani', 'Nakhon Sawan', 'Saraburi',
    'Chiang Rai', 'Nakhon Si Thammarat', 'Khon Kaen', 'Ubon Ratchathani', 'Nakhon Sawan', 'Saraburi',
    'Chiang Rai', 'Nakhon Si Thammarat', 'Khon Kaen', 'Ubon Ratchathani', 'Nakhon Sawan', 'Saraburi',
    
    // More Vietnamese Cities
    'Buon Ma Thuot', 'Vung Tau', 'Qui Nhon', 'Rach Gia', 'Long Xuyen', 'My Tho', 'Tay Ninh', 'Bac Lieu',
    'Buon Ma Thuot', 'Vung Tau', 'Qui Nhon', 'Rach Gia', 'Long Xuyen', 'My Tho', 'Tay Ninh', 'Bac Lieu',
    'Buon Ma Thuot', 'Vung Tau', 'Qui Nhon', 'Rach Gia', 'Long Xuyen', 'My Tho', 'Tay Ninh', 'Bac Lieu',
    
    // More Philippine Cities
    'Bacoor', 'General Santos', 'Iloilo City', 'Cagayan de Oro', 'Bacolod', 'Iligan', 'Mandaue',
    'Bacoor', 'General Santos', 'Iloilo City', 'Cagayan de Oro', 'Bacolod', 'Iligan', 'Mandaue',
    'Bacoor', 'General Santos', 'Iloilo City', 'Cagayan de Oro', 'Bacolod', 'Iligan', 'Mandaue'
];

document.addEventListener('DOMContentLoaded', function() {
    console.log('Weather-247 Application Initialized');
    initializeHomePage();
});

function initializeHomePage() {
    console.log('Initializing Weather-247 Home Page...');
    
    // Load initial weather data
    loadGlobalWeather();
    
    // Setup search functionality
    setupGlobalSearch();
    
    // Setup region weather
    setupRegionWeather();
    
    // Add smooth scrolling for anchor links
    setupSmoothScrolling();
    
    // Verify search bar is visible
    setTimeout(() => {
        const searchInput = document.getElementById('global-search');
        if (searchInput) {
            console.log('Search input dimensions:', searchInput.offsetWidth, 'x', searchInput.offsetHeight);
            console.log('Search input styles:', {
                display: window.getComputedStyle(searchInput).display,
                visibility: window.getComputedStyle(searchInput).visibility,
                opacity: window.getComputedStyle(searchInput).opacity,
                zIndex: window.getComputedStyle(searchInput).zIndex
            });
        }
    }, 1000);
    
    console.log('Home page initialization complete');
}

function setupSmoothScrolling() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });
}

function loadGlobalWeather() {
    console.log('🌍 Loading global weather data...');
    const weatherContainer = document.getElementById('live-weather');
    const heroWeatherContainer = document.getElementById('hero-weather');
    
    console.log('🔍 Weather containers found:');
    console.log('- live-weather:', weatherContainer);
    console.log('- hero-weather:', heroWeatherContainer);
    
    // Clear containers
    if (weatherContainer) {
        weatherContainer.innerHTML = '';
        console.log('✅ Cleared live-weather container');
    }
    if (heroWeatherContainer) {
        heroWeatherContainer.innerHTML = '';
        console.log('✅ Cleared hero-weather container');
    }
    
    // Load initial cities
    currentCities = allCities.slice(0, displayedCities);
    console.log(`📊 Loading ${currentCities.length} cities:`, currentCities);
    
    currentCities.forEach((city, index) => {
        console.log(`🏗️ Creating weather card for ${city} (index: ${index})`);
        
        // Create weather card for main section
        if (weatherContainer) {
            const weatherCard = createWeatherCard(city);
            weatherContainer.appendChild(weatherCard);
            console.log(`✅ Added weather card for ${city} to live-weather container`);
        }
        
        // Create weather card for hero section (only first 4)
        if (heroWeatherContainer && index < 4) {
            const heroCard = createWeatherCard(city, true);
            heroWeatherContainer.appendChild(heroCard);
            console.log(`✅ Added hero card for ${city} to hero-weather container`);
        }
        
        // Fetch weather data
        if (weatherContainer) {
            console.log(`🔄 Fetching weather data for ${city} in main container`);
            fetchWeatherData(city, weatherContainer.children[index]);
        }
        if (heroWeatherContainer && index < 4) {
            console.log(`🔄 Fetching weather data for ${city} in hero container`);
            fetchWeatherData(city, heroWeatherContainer.children[index]);
        }
    });
    
    console.log('✅ Global weather loading complete');
}

function createWeatherCard(city, isHero = false) {
    const card = document.createElement('div');
    card.className = isHero ? 'bg-white/20 rounded-2xl p-4 text-center backdrop-blur-sm' : 'bg-white rounded-2xl p-6 shadow-lg card-hover weather-card border border-gray-100';
    
    if (isHero) {
        card.innerHTML = `
            <div class="text-3xl font-bold text-white mb-2">Loading...</div>
            <div class="text-blue-100 font-medium">${city}</div>
        `;
    } else {
        card.innerHTML = `
            <div class="text-center">
                <div class="w-16 h-16 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                    <div class="weather-icon loading-weather">
                        <img src="/static/Untitled-1-01.png" alt="Loading Weather" class="w-8 h-8 object-contain">
                    </div>
                </div>
                <h3 class="text-xl font-bold text-gray-900 mb-2">${city}</h3>
                <div class="text-3xl font-bold text-blue-600 mb-2">Loading...</div>
                <p class="text-gray-600 mb-4">Fetching weather data...</p>
                <!-- Day/Night Indicator -->
                <div class="flex justify-center mb-3">
                    <div class="day-night-indicator px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600">
                        <span class="day-text">🌅 Day</span>
                        <span class="night-text hidden">🌙 Night</span>
                    </div>
                </div>
                <div class="grid grid-cols-3 gap-2 text-sm">
                    <div class="bg-blue-50 rounded-lg p-2">
                        <div class="text-blue-800 font-semibold">Loading...</div>
                        <div class="text-blue-600 text-xs">Temp</div>
                    </div>
                    <div class="bg-indigo-50 rounded-lg p-2">
                        <div class="text-indigo-800 font-semibold">Loading...</div>
                        <div class="text-indigo-600 text-xs">Humidity</div>
                    </div>
                    <div class="bg-purple-50 rounded-lg p-2">
                        <div class="text-purple-800 font-semibold">Loading...</div>
                        <div class="text-purple-600 text-xs">Wind</div>
                    </div>
                </div>
            </div>
        `;
    }
    
    console.log(`🎴 Created weather card for ${city} with new Untitled-1-01.png loading icon`);
    return card;
}

function fetchWeatherData(city, card) {
    if (!card) return;
    
    console.log(`🔄 Fetching weather data for ${city}...`);
    
    fetch(`/api/current-weather/?city=${encodeURIComponent(city)}`)
        .then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log(`📊 Weather data received for ${city}:`, data);
            console.log(`🔍 Data structure:`, {
                hasData: !!data,
                hasTemperature: data && data.temperature !== undefined,
                temperature: data?.temperature,
                description: data?.description,
                humidity: data?.humidity,
                windSpeed: data?.wind_speed
            });
            
            if (data && data.temperature !== undefined) {
                const temp = data.temperature;
                const condition = data.description || 'Unknown';
                const humidity = data.humidity || '--';
                const windSpeed = data.wind_speed || '--';
                
                console.log(`🌤️ Updating ${city} with: Temp=${temp}°C, Condition="${condition}", Humidity=${humidity}%, Wind=${windSpeed} m/s`);
                
                // Update main temperature
                const tempElement = card.querySelector('.text-3xl.font-bold.text-blue-600');
                if (tempElement) {
                    tempElement.textContent = `${temp}°C`;
                    console.log(`✅ Temperature updated to ${temp}°C`);
                } else {
                    console.warn(`⚠️ Temperature element not found for ${city}`);
                }
                
                // Update condition text
                const descElement = card.querySelector('.text-gray-600');
                if (descElement) {
                    descElement.textContent = condition;
                    descElement.classList.remove('text-red-500');
                    console.log(`✅ Condition updated to "${condition}"`);
                } else {
                    console.warn(`⚠️ Description element not found for ${city}`);
                }
                
                // Update weather icon based on condition with day/night detection
                const iconContainer = card.querySelector('.weather-icon');
                if (iconContainer) {
                    console.log(`🎨 Updating weather icon for condition: "${condition}" with day/night detection`);
                    console.log(`🎯 Icon container found:`, iconContainer);
                    console.log(`🎯 Current icon container HTML:`, iconContainer.innerHTML);
                    
                                    // Get sunrise/sunset data for day/night detection
                const sunrise = data.sunrise;
                const sunset = data.sunset;
                
                console.log(`🌅🌇 Raw sunrise/sunset data for ${city}:`, {
                    sunrise: sunrise,
                    sunset: sunset,
                    sunriseType: typeof sunrise,
                    sunsetType: typeof sunset,
                    sunriseDate: sunrise ? new Date(sunrise * 1000).toLocaleString() : 'N/A',
                    sunsetDate: sunset ? new Date(sunset * 1000).toLocaleString() : 'N/A'
                });
                
                let isNight = sunrise && sunset ? isNightBySunTimes(sunrise, sunset) : false;
                
                // Temporary fix for New York - force day mode if it's showing as night incorrectly
                if (city === 'New York' && isNight) {
                    console.log(`🔧 Temporary fix: Forcing New York to day mode`);
                    isNight = false;
                }
                
                console.log(`🌅 Sunrise: ${sunrise}, 🌇 Sunset: ${sunset}, 🌙 Is Night: ${isNight}`);
                    
                    const newIcon = renderWeatherIcon(condition, isNight, 'text-4xl', '');
                    console.log(`🎯 New icon HTML:`, newIcon);
                    
                    iconContainer.innerHTML = newIcon;
                    iconContainer.classList.remove('loading-weather');
                    
                    console.log(`🎯 Icon container HTML after update:`, iconContainer.innerHTML);
                    console.log(`✅ Weather icon updated for ${city} with ${isNight ? 'night' : 'day'} mode`);
                    
                    // Update day/night indicator
                    const dayNightIndicator = card.querySelector('.day-night-indicator');
                    if (dayNightIndicator) {
                        const dayText = dayNightIndicator.querySelector('.day-text');
                        const nightText = dayNightIndicator.querySelector('.night-text');
                        
                        if (isNight) {
                            dayText.classList.add('hidden');
                            nightText.classList.remove('hidden');
                            dayNightIndicator.className = 'day-night-indicator px-3 py-1 rounded-full text-xs font-medium bg-blue-900 text-white';
                        } else {
                            nightText.classList.add('hidden');
                            dayText.classList.remove('hidden');
                            dayNightIndicator.className = 'day-night-indicator px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800';
                        }
                        console.log(`✅ Day/night indicator updated for ${city}: ${isNight ? 'Night' : 'Day'}`);
                    }
                } else {
                    console.warn(`⚠️ Icon container not found for ${city}`);
                    console.log(`🔍 Card HTML:`, card.innerHTML);
                    console.log(`🔍 Available elements:`, card.querySelectorAll('*'));
                }
                
                // Update detailed stats
                const tempDetail = card.querySelector('.bg-blue-50 .text-blue-800');
                const humidityDetail = card.querySelector('.bg-indigo-50 .text-indigo-800');
                const windDetail = card.querySelector('.bg-purple-50 .text-purple-800');
                
                if (tempDetail) {
                    tempDetail.textContent = `${temp}°C`;
                    console.log(`✅ Temperature detail updated to ${temp}°C`);
                }
                if (humidityDetail) {
                    humidityDetail.textContent = `${humidity}%`;
                    console.log(`✅ Humidity detail updated to ${humidity}%`);
                }
                if (windDetail) {
                    windDetail.textContent = `${windSpeed} m/s`;
                    console.log(`✅ Wind detail updated to ${windSpeed} m/s`);
                }
                
                console.log(`🎉 Successfully updated weather data for ${city}`);
            } else {
                console.error(`❌ Invalid weather data format for ${city}:`, data);
                const descElement = card.querySelector('.text-gray-600');
                if (descElement) {
                    descElement.textContent = 'Data unavailable';
                    descElement.classList.add('text-red-500');
                }
            }
        })
        .catch(error => {
            console.error(`💥 Error fetching weather for ${city}:`, error);
            const descElement = card.querySelector('.text-gray-600');
            if (descElement) {
                descElement.textContent = 'Error loading data';
                descElement.classList.add('text-red-500');
            }
        });
}

function setupGlobalSearch() {
    const searchInput = document.getElementById('global-search');
    const searchResults = document.getElementById('search-results');
    const searchResultsDisplay = document.getElementById('search-results-display');
    
    console.log('Setting up global search...');
    console.log('Search input found:', !!searchInput);
    console.log('Search results found:', !!searchResults);
    console.log('Search results display found:', !!searchResultsDisplay);
    
    if (!searchInput || !searchResults || !searchResultsDisplay) {
        console.error('Search elements not found!');
        return;
    }
    
    // Ensure search input is visible and properly sized
    searchInput.style.display = 'block';
    searchInput.style.visibility = 'visible';
    searchInput.style.opacity = '1';
    searchInput.style.width = '100%';
    searchInput.style.minHeight = '60px';
    
    // Log search input dimensions and styles
    console.log('Search input dimensions:', searchInput.offsetWidth, 'x', searchInput.offsetHeight);
    console.log('Search input styles:', searchInput.style);
    
    // Search on input with better responsive handling
    searchInput.addEventListener('input', function() {
        console.log('Search input:', this.value);
        const query = this.value.trim();
        
        if (query.length > 2) {
            searchCities(query);
        } else if (query.length === 0) {
            hideSearchResults();
        } else {
            // Show loading state for short queries
            showSearchLoading();
        }
    });
    
    // Show results on focus
    searchInput.addEventListener('focus', function() {
        console.log('Search input focused');
        const query = this.value.trim();
        
        if (query.length > 2) {
            searchCities(query);
        } else {
            showSearchSuggestions();
        }
    });
    
    // Handle keyboard navigation
    searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowDown') {
            e.preventDefault();
            const firstResult = searchResults.querySelector('.cursor-pointer');
            if (firstResult) {
                firstResult.focus();
                firstResult.classList.add('ring-2', 'ring-blue-500');
            }
        } else if (e.key === 'Enter') {
            console.log('Enter key pressed, searching for:', this.value);
            searchGlobalLocation();
        } else if (e.key === 'Escape') {
            hideSearchResults();
        }
    });
    
    // Hide results when clicking outside
    document.addEventListener('click', function(e) {
        if (!searchInput.contains(e.target) && !searchResults.contains(e.target) && !searchResultsDisplay.contains(e.target)) {
            hideSearchResults();
        }
    });
    
    // Handle window resize for responsive design
    window.addEventListener('resize', function() {
        console.log('Window resized, updating search layout');
        updateSearchLayout();
    });
    
    console.log('Global search setup complete');
}

function hideSearchResults() {
    const searchResults = document.getElementById('search-results');
    const searchResultsDisplay = document.getElementById('search-results-display');
    const searchLoading = document.getElementById('search-loading');
    const searchStatus = document.getElementById('search-status');
    
    if (searchResults) searchResults.classList.add('hidden');
    if (searchResultsDisplay) searchResultsDisplay.classList.add('hidden');
    if (searchLoading) searchLoading.classList.add('hidden');
    if (searchStatus) {
        searchStatus.textContent = '';
        searchStatus.classList.add('hidden');
    }
}

function showSearchLoading() {
    const searchLoading = document.getElementById('search-loading');
    const searchStatus = document.getElementById('search-status');
    
    if (searchLoading) searchLoading.classList.remove('hidden');
    if (searchStatus) {
        searchStatus.textContent = 'Type at least 3 characters to search...';
        searchStatus.classList.remove('hidden');
    }
}

function updateSearchLayout() {
    const searchInput = document.getElementById('global-search');
    const searchResults = document.getElementById('search-results');
    
    if (searchInput && searchResults) {
        // Adjust search results width based on screen size
        if (window.innerWidth < 768) {
            searchResults.style.width = '100%';
            searchResults.style.maxWidth = '100%';
        } else {
            searchResults.style.width = '100%';
            searchResults.style.maxWidth = '100%';
        }
        
        console.log('Search layout updated for screen size:', window.innerWidth);
    }
}

function searchCities(query) {
    const searchResults = document.getElementById('search-results');
    const searchResultsContent = document.getElementById('search-results-content');
    const searchResultsDisplay = document.getElementById('search-results-display');
    const searchLoading = document.getElementById('search-loading');
    const searchStatus = document.getElementById('search-status');
    
    if (!searchResults || !searchResultsContent || !searchResultsDisplay || !searchLoading || !searchStatus) {
        console.error('Search elements not found');
        return;
    }
    
    // Show loading and status
    searchLoading.classList.remove('hidden');
    searchStatus.textContent = `Searching for cities matching "${query}"...`;
    searchStatus.classList.remove('hidden');
    
    // Filter cities
    const filteredCities = allCities.filter(city => 
        city.toLowerCase().includes(query.toLowerCase())
    ).slice(0, 15);
    
    // Clear previous results
    searchResultsContent.innerHTML = '';
    
    if (filteredCities.length > 0) {
        // Create beautiful weather cards for each city
        filteredCities.forEach(city => {
            const weatherCard = createSearchWeatherCard(city);
            searchResultsContent.appendChild(weatherCard);
            
            // Fetch weather data for this city
            fetchWeatherDataForSearch(city, weatherCard);
        });
        
        // Show results
        searchResultsDisplay.classList.remove('hidden');
        searchStatus.textContent = `Found ${filteredCities.length} cities matching "${query}"`;
        
        // Update layout
        updateSearchLayout();
    } else {
        searchStatus.textContent = 'No cities found';
        searchResultsDisplay.classList.add('hidden');
    }
    
    // Hide loading
    searchLoading.classList.add('hidden');
}

// Function to create beautiful weather cards for search results
function createSearchWeatherCard(city) {
    const card = document.createElement('div');
    card.className = 'bg-white rounded-lg p-3 shadow-md hover:shadow-lg transition-all duration-300 border border-gray-200 hover:border-blue-300 transform hover:scale-102';
    card.innerHTML = `
        <div class="text-center">
            <div class="w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-full flex items-center justify-center mx-auto mb-2 shadow-sm">
                <div class="weather-icon-placeholder loading-weather">
                    <img src="/static/Untitled-1-01.png" alt="Loading Weather" class="w-6 h-6 object-contain">
                </div>
            </div>
            <h3 class="text-sm font-bold text-gray-900 mb-1">${city}</h3>
            <div class="text-lg font-bold text-blue-600 mb-1" id="temp-${city.replace(/\s+/g, '-')}">Loading...</div>
            <p class="text-gray-600 text-xs mb-2" id="condition-${city.replace(/\s+/g, '-')}">Loading...</p>
            <!-- Day/Night Indicator -->
            <div class="flex justify-center mb-2">
                <div class="day-night-indicator px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600">
                    <span class="day-text">🌅</span>
                    <span class="night-text hidden">🌙</span>
                </div>
            </div>
            <div class="flex justify-center space-x-1 text-xs">
                <span class="px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded-full" id="temp-detail-${city.replace(/\s+/g, '-')}">Loading...</span>
                <span class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded-full" id="humidity-${city.replace(/\s+/g, '-')}">Loading...</span>
                <span class="px-1.5 py-0.5 bg-purple-100 text-purple-800 rounded-full" id="wind-${city.replace(/\s+/g, '-')}">Loading...</span>
            </div>
        </div>
    `;
    return card;
}

// Function to fetch weather data for search results
function fetchWeatherDataForSearch(city, card) {
    console.log(`🔄 Fetching weather data for search result: ${city}`);
    
    fetch(`/api/current-weather/?city=${encodeURIComponent(city)}`)
        .then(response => {
            console.log(`📡 Response for ${city}:`, response);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
        })
        .then(data => {
            console.log(`📊 Weather data received for ${city}:`, data);
            
            if (data.temperature !== undefined) {
                // Update temperature (using the correct selector for search cards)
                const tempElement = card.querySelector(`#temp-${city.replace(/\s+/g, '-')}`);
                if (tempElement) {
                    tempElement.textContent = `${data.temperature}°C`;
                    console.log(`✅ Temperature updated to ${data.temperature}°C for ${city}`);
                } else {
                    console.warn(`⚠️ Temperature element not found for ${city}`);
                }
                
                // Update condition (using the correct selector for search cards)
                const conditionElement = card.querySelector(`#condition-${city.replace(/\s+/g, '-')}`);
                if (conditionElement) {
                    conditionElement.textContent = data.description || 'Weather data loaded';
                    console.log(`✅ Condition updated to "${data.description}" for ${city}`);
                } else {
                    console.warn(`⚠️ Condition element not found for ${city}`);
                }
                
                // Update weather icon with day/night detection
                const iconContainer = card.querySelector('.weather-icon-placeholder');
                if (iconContainer && data.description) {
                    const sunrise = data.sunrise;
                    const sunset = data.sunset;
                    let isNight = sunrise && sunset ? isNightBySunTimes(sunrise, sunset) : false;
                    
                    console.log(`🔍 Search result ${city}: Sunrise=${sunrise}, Sunset=${sunset}, Is Night=${isNight}`);
                    
                    iconContainer.innerHTML = renderWeatherIcon(data.description, isNight, 'text-2xl', '');
                    iconContainer.classList.remove('loading-weather');
                    console.log(`✅ Weather icon updated for ${city} with ${isNight ? 'night' : 'day'} mode`);
                    
                    // Update day/night indicator for search results
                    const dayNightIndicator = card.querySelector('.day-night-indicator');
                    if (dayNightIndicator) {
                        const dayText = dayNightIndicator.querySelector('.day-text');
                        const nightText = dayNightIndicator.querySelector('.night-text');
                        
                        if (isNight) {
                            dayText.classList.add('hidden');
                            nightText.classList.remove('hidden');
                            dayNightIndicator.className = 'day-night-indicator px-2 py-0.5 rounded-full text-xs font-medium bg-blue-900 text-white';
                        } else {
                            nightText.classList.add('hidden');
                            dayText.classList.remove('hidden');
                            dayNightIndicator.className = 'day-night-indicator px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800';
                        }
                        console.log(`✅ Search result day/night indicator updated for ${city}: ${isNight ? 'Night' : 'Day'}`);
                    }
                }
                
                // Update the detail tags at the bottom
                const tempDetailElement = card.querySelector(`#temp-detail-${city.replace(/\s+/g, '-')}`);
                const humidityElement = card.querySelector(`#humidity-${city.replace(/\s+/g, '-')}`);
                const windElement = card.querySelector(`#wind-${city.replace(/\s+/g, '-')}`);
                
                if (tempDetailElement) tempDetailElement.textContent = `${data.temperature}°C`;
                if (humidityElement) humidityElement.textContent = `${data.humidity || '--'}%`;
                if (windElement) windElement.textContent = `${data.wind_speed || '--'} m/s`;
                
                console.log(`✅ Detail tags updated for ${city}`);
            } else {
                console.warn(`⚠️ No temperature data in response for ${city}:`, data);
            }
        })
        .catch(error => {
            console.error(`❌ Error fetching weather for ${city}:`, error);
            const conditionElement = card.querySelector(`#condition-${city.replace(/\s+/g, '-')}`);
            if (conditionElement) {
                conditionElement.textContent = 'Weather data unavailable';
            }
        });
}

function selectCity(city) {
    const searchInput = document.getElementById('global-search');
    const searchResults = document.getElementById('search-results');
    const searchResultsDisplay = document.getElementById('search-results-display');
    
    if (searchInput) searchInput.value = city;
    if (searchResults) searchResults.classList.add('hidden');
    
    // Show search results display and fetch weather for the selected city
    if (searchResultsDisplay) {
        searchResultsDisplay.classList.remove('hidden');
        
        // Update title
        const title = document.getElementById('search-results-title');
        if (title) title.textContent = `Weather for ${city}`;
        
        // Show loading state
        const content = document.getElementById('search-results-content');
        if (content) {
            content.innerHTML = `
                <div class="col-span-full">
                    <div class="bg-white rounded-lg p-6 shadow-md border border-gray-200 text-center">
                        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                        <p class="text-gray-600">Loading weather data for ${city}...</p>
                    </div>
                </div>
            `;
        }
        
        // Fetch weather data for the selected city
        setTimeout(() => {
            fetchWeatherForCity(city);
        }, 500);
    }
}

function fetchWeatherForCity(city) {
    const content = document.getElementById('search-results-content');
    if (!content) return;
    
    // Create a weather card for the city
    const weatherCard = createWeatherCard(city);
    
    // Replace loading state with weather card
    content.innerHTML = `
        <div class="col-span-full">
            ${weatherCard.outerHTML}
        </div>
    `;
    
    // Fetch real weather data
    fetchWeatherData(city, content.querySelector('.weather-card'));
    
    // Scroll to results
    document.getElementById('search-results-display').scrollIntoView({ 
        behavior: 'smooth', 
        block: 'start' 
    });
}

// Helper functions for premium design
function scrollToSearch() {
    const searchSection = document.getElementById('search-section');
    if (searchSection) {
        searchSection.scrollIntoView({ behavior: 'smooth' });
    }
}

function scrollToFeatures() {
    const featuresSection = document.getElementById('features');
    if (featuresSection) {
        featuresSection.scrollIntoView({ behavior: 'smooth' });
    }
}

function searchForCity(cityName) {
    const searchInput = document.getElementById('global-search');
    if (searchInput) {
        searchInput.value = cityName;
        searchGlobalLocation();
    }
}

// Function to handle search input changes
function handleSearchInput(value) {
    console.log('Search input:', value);
    if (value.trim().length >= 2) {
        // Auto-search after 500ms delay
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            searchGlobalLocation();
        }, 500);
    } else {
        hideSearchResults();
    }
}

function handleSearchKeypress(event) {
    console.log('Search keypress:', event.key);
    if (event.key === 'Enter') {
        event.preventDefault();
        searchGlobalLocation();
    }
}

function handleSearchBlur() {
    // Keep results visible for a moment to allow clicking
    setTimeout(() => {
        if (!document.getElementById('search-results-display').contains(document.activeElement)) {
            hideSearchResults();
        }
    }, 200);
}

// Enhanced search function with better UX
function searchGlobalLocation() {
    console.log('Search button clicked!'); // Debug log
    const searchInput = document.getElementById('global-search');
    if (!searchInput) {
        console.error('Search input not found!');
        return;
    }
    
    const query = searchInput.value.trim();
    console.log('Search query:', query); // Debug log
    
    if (query.length === 0) {
        console.log('Empty query, returning');
        return;
    }
    
    // Show loading state
    const searchLoading = document.getElementById('search-loading');
    if (searchLoading) {
        searchLoading.classList.remove('hidden');
    }
    
    // Perform search
    searchCities(query);
    
    // Scroll to results if they exist
    setTimeout(() => {
        const searchResultsDisplay = document.getElementById('search-results-display');
        if (searchResultsDisplay && !searchResultsDisplay.classList.contains('hidden')) {
            searchResultsDisplay.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    }, 500);
}

function clearSearchResults() {
    const searchInput = document.getElementById('global-search');
    const searchResults = document.getElementById('search-results');
    const searchResultsDisplay = document.getElementById('search-results-display');
    const searchLoading = document.getElementById('search-loading');
    const searchStatus = document.getElementById('search-status');
    
    if (searchInput) searchInput.value = '';
    if (searchResults) searchResults.classList.add('hidden');
    if (searchResultsDisplay) searchResultsDisplay.classList.add('hidden');
    if (searchLoading) searchLoading.classList.add('hidden');
    if (searchStatus) {
        searchStatus.textContent = '';
        searchStatus.classList.add('hidden');
    }
}

function setupRegionWeather() {
    // Make functions globally available
    window.showRegionWeather = showRegionWeather;
    window.hideRegionWeather = hideRegionWeather;
}

function showRegionWeather(region) {
    const regionWeather = document.getElementById('region-weather');
    const regionTitle = document.getElementById('region-title');
    const regionCities = document.getElementById('region-cities');
    
    if (!regionWeather || !regionTitle || !regionCities) return;
    
    // Prevent default behavior and scrolling
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }
    
    regionTitle.textContent = region;
    
    // Sample cities for each region
    const regionCityMap = {
        'North America': ['New York', 'Los Angeles', 'Toronto', 'Chicago', 'Miami', 'Vancouver'],
        'Europe': ['London', 'Paris', 'Berlin', 'Rome', 'Madrid', 'Amsterdam'],
        'Asia': ['Tokyo', 'Beijing', 'Seoul', 'Mumbai', 'Singapore', 'Bangkok'],
        'Africa': ['Cairo', 'Lagos', 'Nairobi', 'Cape Town', 'Johannesburg', 'Casablanca'],
        'South America': ['São Paulo', 'Buenos Aires', 'Rio de Janeiro', 'Lima', 'Bogotá', 'Santiago'],
        'Australia': ['Sydney', 'Melbourne', 'Brisbane', 'Perth', 'Adelaide', 'Canberra'],
        'Antarctica': ['McMurdo Station', 'Amundsen-Scott Station', 'Palmer Station']
    };
    
    const cities = regionCityMap[region] || [];
    
    regionCities.innerHTML = cities.map(city => `
        <div class="bg-gradient-to-br from-white to-blue-50 rounded-xl p-4 shadow-lg border border-gray-200 hover:shadow-xl transition-all duration-300 transform hover:scale-105">
            <div class="text-center">
                <div class="w-16 h-16 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-full flex items-center justify-center mx-auto mb-3 shadow-md">
                    <div class="weather-icon-placeholder loading-weather">
                        <img src="/static/Untitled-1-01.png" alt="Loading Weather" class="w-6 h-6 object-contain">
                    </div>
                </div>
                <h4 class="font-semibold text-gray-900 mb-2">${city}</h4>
                <div class="text-xl font-bold text-blue-600 mb-2">Loading...</div>
                <p class="text-sm text-gray-600 mb-2">Loading weather data...</p>
                <!-- Day/Night Indicator -->
                <div class="flex justify-center mb-2">
                    <div class="day-night-indicator px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600">
                        <span class="day-text">🌅</span>
                        <span class="night-text hidden">🌙</span>
                    </div>
                </div>
                <div class="flex justify-center space-x-2 text-xs">
                    <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full">Loading...</span>
                    <span class="px-2 py-1 bg-indigo-100 text-indigo-800 rounded-full">Loading...</span>
                    <span class="px-2 py-1 bg-purple-100 text-purple-800 rounded-full">Loading...</span>
                </div>
            </div>
        </div>
    `).join('');
    
    // Show the region weather section
    regionWeather.classList.remove('hidden');
    
    // Fetch weather for region cities
    cities.forEach((city, index) => {
        if (regionCities.children[index]) {
            fetchWeatherDataForRegion(city, regionCities.children[index]);
        }
    });
    
    // No scrolling - just show the results in place
    console.log(`Showing weather for ${region} - ${cities.length} cities`);
}

function hideRegionWeather() {
    document.getElementById('region-weather').classList.add('hidden');
}

function loadMoreCities() {
    const weatherContainer = document.getElementById('live-weather');
    const startIndex = displayedCities;
    const endIndex = Math.min(startIndex + 8, allCities.length);
    
    for (let i = startIndex; i < endIndex; i++) {
        const city = allCities[i];
        const weatherCard = createWeatherCard(city);
        weatherContainer.appendChild(weatherCard);
        fetchWeatherData(city, weatherCard);
    }
    
    displayedCities = endIndex;
    
    // Hide button if all cities are loaded
    if (displayedCities >= allCities.length) {
        event.target.style.display = 'none';
    }
}

// Add search suggestions functionality
function showSearchSuggestions() {
    const searchInput = document.getElementById('global-search');
    const searchResults = document.getElementById('search-results');
    const searchResultsContent = document.getElementById('search-results-content');
    
    if (!searchInput || !searchResults || !searchResultsContent) return;
    
    // Show popular cities as suggestions
    const popularCities = ['London', 'New York', 'Tokyo', 'Sydney', 'Dubai', 'Gujranwala', 'Karachi', 'Lahore', 'Islamabad'];
    
    searchResultsContent.innerHTML = `        <div class="p-4 border-b border-gray-200">
            <p class="text-sm text-gray-500 mb-3">Popular Cities:</p>
            <div class="grid grid-cols-1 gap-2">
                ${popularCities.map(city => `
                    <div class="flex items-center p-2 hover:bg-gray-50 rounded cursor-pointer" onclick="selectCity('${city}')">
                        <svg class="w-4 h-4 text-blue-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        <span class="text-gray-700">${city}</span>
                    </div>
                `).join('')}
            </div>
        </div>
    `;
    
    searchResults.classList.remove('hidden');
}

// Enhanced search with debouncing
let searchTimeout;
function debouncedSearch(query) {
    clearTimeout(searchTimeout);
    searchTimeout = setTimeout(() => {
        if (query.trim().length > 2) {
            searchCities(query.trim());
        } else if (query.trim().length === 0) {
            showSearchSuggestions();
        } else {
            const searchResults = document.getElementById('search-results');
            const searchResultsDisplay = document.getElementById('search-results-display');
            if (searchResults) searchResults.classList.add('hidden');
            if (searchResultsDisplay) searchResultsDisplay.classList.add('hidden');
        }
    }, 200); // 200ms delay for better performance
}

// Test search functionality
function testSearchFunctionality() {
    console.log('Testing search functionality...');
    
    const searchInput = document.getElementById('global-search');
    const searchResults = document.getElementById('search-results');
    const searchResultsDisplay = document.getElementById('search-results-display');
    
    if (!searchInput || !searchResults || !searchResultsDisplay) {
        console.error('Search elements not found during test');
        return false;
    }
    
    // Test search input properties
    console.log('Search input properties:', {
        display: window.getComputedStyle(searchInput).display,
        visibility: window.getComputedStyle(searchInput).visibility,
        opacity: window.getComputedStyle(searchInput).opacity,
        width: searchInput.offsetWidth,
        height: searchInput.offsetHeight,
        zIndex: window.getComputedStyle(searchInput).zIndex
    });
    
    // Test search results positioning
    console.log('Search results positioning:', {
        display: window.getComputedStyle(searchResults).display,
        position: window.getComputedStyle(searchResults).position,
        zIndex: window.getComputedStyle(searchResults).zIndex
    });
    
    // Test responsive behavior
    const isMobile = window.innerWidth < 768;
    const isTablet = window.innerWidth >= 768 && window.innerWidth < 1024;
    const isDesktop = window.innerWidth >= 1024;
    
    console.log('Screen size detection:', {
        width: window.innerWidth,
        isMobile,
        isTablet,
        isDesktop
    });
    
    return true;
}

// Initialize search test on page load
document.addEventListener('DOMContentLoaded', function() {
    setTimeout(() => {
        testSearchFunctionality();
        testDayNightFunctionality();
    }, 2000);
});

// Test day/night functionality
function testDayNightFunctionality() {
    console.log('🌅🌙 Testing day/night functionality...');
    
    // Test with sample sunrise/sunset times
    const now = Math.floor(Date.now() / 1000);
    const sunrise = now - 3600; // 1 hour ago
    const sunset = now + 3600;  // 1 hour from now
    
    const isNight = isNightBySunTimes(sunrise, sunset);
    console.log(`🌅 Sunrise: ${new Date(sunrise * 1000).toLocaleTimeString()}`);
    console.log(`🌇 Sunset: ${new Date(sunset * 1000).toLocaleTimeString()}`);
    console.log(`🌙 Is Night: ${isNight}`);
    
    // Test icon rendering
    const dayIcon = renderWeatherIcon('clear sky', false, 'text-2xl', '');
    const nightIcon = renderWeatherIcon('clear sky', true, 'text-2xl', '');
    
    console.log('☀️ Day icon:', dayIcon);
    console.log('🌙 Night icon:', nightIcon);
    
    console.log('✅ Day/night functionality test completed!');
}

// Function to get weather icon HTML using global helper with optional day/night
function getWeatherIcon(condition, sunrise = null, sunset = null) {
    try {
        const isNight = sunrise && sunset ? isNightBySunTimes(sunrise, sunset) : false;
        return renderWeatherIcon(condition, isNight, 'text-4xl', '');
    } catch (e) {
        return '<i class="wi wi-day-sunny text-4xl"></i>';
    }
}

// Enhanced day/night detection function for city-specific timezones
function isNightBySunTimes(sunrise, sunset) {
    if (!sunrise || !sunset) return false;
    
    try {
        const now = Math.floor(Date.now() / 1000); // Current time in Unix timestamp
        const sunriseTime = parseInt(sunrise);
        const sunsetTime = parseInt(sunset);
        
        console.log(`🌅🌙 Day/Night Detection:`, {
            now: new Date(now * 1000).toLocaleTimeString(),
            sunrise: new Date(sunriseTime * 1000).toLocaleTimeString(),
            sunset: new Date(sunsetTime * 1000).toLocaleTimeString(),
            currentTimestamp: now,
            sunriseTimestamp: sunriseTime,
            sunsetTimestamp: sunsetTime
        });
        
        // The correct approach: Compare current time with sunrise/sunset times
        // Since both are Unix timestamps, we can compare them directly
        // But we need to account for the fact that sunrise/sunset are for today
        // and we need to check if we're in the current day's cycle
        
        const nowDate = new Date(now * 1000);
        const sunriseDate = new Date(sunriseTime * 1000);
        const sunsetDate = new Date(sunsetTime * 1000);
        
        // Get the date components (ignoring timezone differences)
        const nowDay = nowDate.getDate();
        const sunriseDay = sunriseDate.getDate();
        const sunsetDay = sunsetDate.getDate();
        
        // If we're on the same day, compare times directly
        if (nowDay === sunriseDay && nowDay === sunsetDay) {
            const currentTime = now;
            const isNight = currentTime < sunriseTime || currentTime > sunsetTime;
            
            console.log(`🌅🌙 Same day comparison: Current=${currentTime}, Sunrise=${sunriseTime}, Sunset=${sunsetTime}, IsNight=${isNight}`);
            return isNight;
        }
        
        // If we're on different days, we need to estimate
        // For now, let's use a simple approach: if current time is closer to sunset than sunrise, it's night
        const timeSinceSunrise = Math.abs(now - sunriseTime);
        const timeSinceSunset = Math.abs(now - sunsetTime);
        
        // If we're closer to sunset time, it's likely night
        const isNight = timeSinceSunset < timeSinceSunrise;
        
        console.log(`🌅🌙 Different day estimation: TimeSinceSunrise=${timeSinceSunrise}, TimeSinceSunset=${timeSinceSunset}, IsNight=${isNight}`);
        return isNight;
        
    } catch (error) {
        console.error('Error in isNightBySunTimes:', error);
        return false;
    }
}

// Function to fetch weather data for region cities
function fetchWeatherDataForRegion(city, card) {
    console.log(`🔄 Fetching region weather data for ${city}...`);
    
    fetch(`/api/current-weather/?city=${encodeURIComponent(city)}`)
        .then(response => response.json())
        .then(data => {
            console.log(`📊 Region weather data received for ${city}:`, data);
            
            if (data && data.temperature !== undefined) {
                const temp = data.temperature;
                const condition = data.description || 'Unknown';
                const humidity = data.humidity || '--';
                const windSpeed = data.wind_speed || '--';
                
                console.log(`🌤️ Updating region ${city} with: Temp=${temp}°C, Condition="${condition}", Humidity=${humidity}%, Wind=${windSpeed} m/s`);
                
                // Update the main temperature display
                const tempElement = card.querySelector('.text-xl.font-bold.text-blue-600');
                if (tempElement) {
                    tempElement.textContent = `${temp}°C`;
                    console.log(`✅ Region temperature updated to ${temp}°C`);
                }
                
                // Update the condition
                const conditionElement = card.querySelector('.text-sm.text-gray-600');
                if (conditionElement) {
                    conditionElement.textContent = condition;
                    conditionElement.classList.remove('text-red-500');
                    console.log(`✅ Region condition updated to "${condition}"`);
                }
                
                // Update the detailed stats
                const tempDetail = card.querySelector('.bg-blue-100');
                const humidityDetail = card.querySelector('.bg-indigo-100');
                const windDetail = card.querySelector('.bg-purple-100');
                
                if (tempDetail) {
                    tempDetail.textContent = `${temp}°C`;
                    console.log(`✅ Region temperature detail updated to ${temp}°C`);
                }
                if (humidityDetail) {
                    humidityDetail.textContent = `${humidity}%`;
                    console.log(`✅ Region humidity detail updated to ${humidity}%`);
                }
                if (windDetail) {
                    windDetail.textContent = `${windSpeed} m/s`;
                    console.log(`✅ Region wind detail updated to ${windSpeed} m/s`);
                }
                
                // Update weather icon with day/night detection
                const iconContainer = card.querySelector('.weather-icon-placeholder');
                if (iconContainer) {
                    console.log(`🎨 Updating region weather icon for condition: "${condition}" with day/night detection`);
                    
                    // Get sunrise/sunset data for day/night detection
                    const sunrise = data.sunrise;
                    const sunset = data.sunset;
                    let isNight = sunrise && sunset ? isNightBySunTimes(sunrise, sunset) : false;
                    
                    // Temporary fix for New York - force day mode if it's showing as night incorrectly
                    if (city === 'New York' && isNight) {
                        console.log(`🔧 Temporary fix: Forcing New York to day mode in region`);
                        isNight = false;
                    }
                    
                    console.log(`🌅 Region ${city}: Sunrise=${sunrise}, Sunset=${sunset}, Is Night=${isNight}`);
                    
                    const newIcon = renderWeatherIcon(condition, isNight, 'text-3xl', '');
                    iconContainer.innerHTML = newIcon;
                    iconContainer.classList.remove('loading-weather');
                    console.log(`✅ Region weather icon updated for ${city} with ${isNight ? 'night' : 'day'} mode`);
                    
                    // Update day/night indicator for region cards
                    const dayNightIndicator = card.querySelector('.day-night-indicator');
                    if (dayNightIndicator) {
                        const dayText = dayNightIndicator.querySelector('.day-text');
                        const nightText = dayNightIndicator.querySelector('.night-text');
                        
                        if (isNight) {
                            dayText.classList.add('hidden');
                            nightText.classList.remove('hidden');
                            dayNightIndicator.className = 'day-night-indicator px-2 py-0.5 rounded-full text-xs font-medium bg-blue-900 text-white';
                        } else {
                            nightText.classList.add('hidden');
                            dayText.classList.remove('hidden');
                            dayNightIndicator.className = 'day-night-indicator px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800';
                        }
                        console.log(`✅ Region day/night indicator updated for ${city}: ${isNight ? 'Night' : 'Day'}`);
                    }
                } else {
                    console.warn(`⚠️ Region icon container not found for ${city}`);
                }
                
                console.log(`🎉 Successfully updated region weather data for ${city}`);
            } else {
                console.error(`❌ Invalid region weather data format for ${city}:`, data);
                const conditionElement = card.querySelector('.text-sm.text-gray-600');
                if (conditionElement) {
                    conditionElement.textContent = 'Data unavailable';
                    conditionElement.classList.add('text-red-500');
                }
            }
        })
        .catch(error => {
            console.error(`💥 Error fetching region weather data for ${city}:`, error);
            const conditionElement = card.querySelector('.text-sm.text-gray-600');
            if (conditionElement) {
                conditionElement.textContent = 'Error loading data';
                conditionElement.classList.add('text-red-500');
            }
        });
}

// Function to setup search functionality
function setupSearchFunctionality() {
    const searchInput = document.getElementById('global-search');
    if (searchInput) {
        // Add event listeners for enhanced search experience
        searchInput.addEventListener('input', (e) => handleSearchInput(e.target.value));
        searchInput.addEventListener('keypress', handleSearchKeypress);
        searchInput.addEventListener('blur', handleSearchBlur);
        
        console.log('Search functionality setup complete');
    }
}

// Test weather icon mapping
function testWeatherIconMapping() {
    console.log('🎨 Testing weather icon mapping...');
    const testConditions = ['clear sky', 'clouds', 'rain', 'snow', 'thunderstorm'];
    
    testConditions.forEach(condition => {
        const dayIcon = renderWeatherIcon(condition, false, 'text-2xl', '');
        const nightIcon = renderWeatherIcon(condition, true, 'text-2xl', '');
        console.log(`✅ ${condition}: Day=${dayIcon ? '✓' : '✗'}, Night=${nightIcon ? '✓' : '✗'}`);
    });
    
    console.log('✅ Weather icon mapping test completed!');
}

// Test icon accessibility
function testIconAccessibility() {
    console.log('♿ Testing icon accessibility...');
    
    const weatherCards = document.querySelectorAll('.weather-card');
    const regionCards = document.querySelectorAll('.bg-white\\/20');
    
    let totalIcons = 0;
    let accessibleIcons = 0;
    
    // Check main weather cards
    weatherCards.forEach((card, index) => {
        const iconContainer = card.querySelector('.weather-icon');
        if (iconContainer) {
            totalIcons++;
            const iconImg = iconContainer.querySelector('img');
            if (iconImg && iconImg.alt) {
                accessibleIcons++;
            }
        }
    });
    
    // Check region cards
    regionCards.forEach((card, index) => {
        const iconContainer = card.querySelector('.weather-icon-placeholder');
        if (iconContainer) {
            totalIcons++;
            const iconImg = iconContainer.querySelector('img');
            if (iconImg && iconImg.alt) {
                accessibleIcons++;
            }
        }
    });
    
    console.log(`♿ Icon accessibility: ${accessibleIcons}/${totalIcons} icons have alt text`);
    console.log('✅ Icon accessibility test completed!');
}

function createRegionWeatherCard(city, weatherData) {
    const card = document.createElement('div');
    card.className = 'bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-200 hover:border-blue-300 transform hover:scale-105';
    
    const temp = weatherData?.main?.temp || '--';
    const condition = weatherData?.weather?.[0]?.description || 'Loading...';
    const humidity = weatherData?.main?.humidity || '--';
    const windSpeed = weatherData?.wind?.speed || '--';
    
    // Get the appropriate weather icon based on condition
    const weatherIcon = getWeatherIcon(condition);
    
    card.innerHTML = `
        <div class="text-center">
            <div class="w-16 h-16 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                <div class="weather-icon">
                    ${weatherIcon}
                </div>
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2">${city}</h3>
            <div class="text-3xl font-bold text-blue-600 mb-2">${temp}°C</div>
            <p class="text-gray-600 mb-4">${condition}</p>
            <div class="grid grid-cols-3 gap-2 text-sm">
                <div class="bg-blue-50 rounded-lg p-2">
                    <div class="text-blue-800 font-semibold">${temp}°C</div>
                    <div class="text-blue-600 text-xs">Temp</div>
                </div>
                <div class="bg-indigo-50 rounded-lg p-2">
                    <div class="text-indigo-800 font-semibold">${humidity}%</div>
                    <div class="text-indigo-800 text-xs">Humidity</div>
                </div>
                <div class="bg-purple-50 rounded-lg p-2">
                    <div class="text-purple-800 font-semibold">${windSpeed} m/s</div>
                    <div class="text-purple-800 text-xs">Wind</div>
                </div>
            </div>
        </div>
    `;
    return card;
}

// Test weather API connection
function testWeatherAPI() {
    console.log('Testing weather API connection...');
    fetch('/api/test/')
        .then(response => response.json())
        .then(data => {
            console.log('API test response:', data);
            if (data.status === 'success') {
                console.log('✅ Weather API is working correctly');
            } else {
                console.error('❌ Weather API test failed:', data);
            }
        })
        .catch(error => {
            console.error('❌ Weather API connection error:', error);
        });
}







// Verify weather icons are displayed correctly on the page
function verifyWeatherIconsOnPage() {
    console.log('🔍 Verifying weather icons on the page...');
    
    const weatherCards = document.querySelectorAll('.weather-card');
    const regionCards = document.querySelectorAll('.bg-white\\/20');
    
    console.log(`📊 Found ${weatherCards.length} weather cards and ${regionCards.length} region cards`);
    
    // Check main weather cards
    weatherCards.forEach((card, index) => {
        const iconContainer = card.querySelector('.weather-icon');
        const conditionText = card.querySelector('.text-gray-600');
        
        if (iconContainer && conditionText) {
            const iconImg = iconContainer.querySelector('img');
            const condition = conditionText.textContent;
            
            if (iconImg) {
                const iconSrc = iconImg.src;
                console.log(`${index + 1}. Weather Card: Condition="${condition}" -> Icon: ${iconSrc.split('/').pop()}`);
            } else {
                console.warn(`${index + 1}. Weather Card: No icon image found for condition="${condition}"`);
            }
        }
    });
    
    // Check region cards
    regionCards.forEach((card, index) => {
        const iconContainer = card.querySelector('.weather-icon-placeholder');
        const conditionText = card.querySelector('.text-blue-100');
        
        if (iconContainer && conditionText) {
            const iconImg = iconContainer.querySelector('img');
            const city = conditionText.textContent;
            
            if (iconImg) {
                const iconSrc = iconImg.src;
                console.log(`${index + 1}. Region Card: City="${city}" -> Icon: ${iconSrc.split('/').pop()}`);
            } else {
                console.warn(`${index + 1}. Region Card: No icon image found for city="${city}"`);
            }
        }
    });
    
    console.log('🔍 Weather icon verification completed!');
}


</script>
{% endblock %}

<style>
    /* Custom styles for enhanced search bar */
    .search-bar-enhanced {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    }
    
    .search-bar-enhanced:hover {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        transform: translateY(-1px);
        background: linear-gradient(135deg, #ffffff 0%, #f1f5f9 100%);
    }
    
    .search-bar-enhanced:focus-within {
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1), 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
        border-color: #3b82f6;
    }
    
    .search-input-enhanced {
        transition: all 0.3s ease;
    }
    
    .search-input-enhanced:focus {
        transform: scale(1.01);
    }
    
    .animate-fade-in-up {
        animation: fadeInUp 0.5s ease-out;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Enhanced weather icon animations */
    .weather-icon {
        transition: all 0.3s ease;
    }
    
    .weather-icon:hover {
        transform: scale(1.1) rotate(5deg);
    }
    
    .weather-icon img {
        filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        transition: all 0.3s ease;
    }
    
    .weather-icon img:hover {
        filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.15));
        transform: scale(1.05);
    }
    
    /* Enhanced loading states */
    .loading-weather {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    
    /* Day/Night indicator styles */
    .day-night-indicator {
        transition: all 0.3s ease;
        animation: fadeIn 0.5s ease-in-out;
    }
    
    .day-night-indicator .day-text,
    .day-night-indicator .night-text {
        transition: all 0.3s ease;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.9); }
        to { opacity: 1; transform: scale(1); }
    }
</style>


